{# Jinja macro for rendering tables #}
{% macro neat_table(headers, rows, view_type=None) %}
<table class="neat-table">
    <thead>
        <tr>
        {% for header in headers %}
            <th>{{ header }}</th>
        {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for row in rows %}
            <tr>
                {% if view_type == 'sales' %}
                    <td>{{ row['BillNo'] }}</td>
                    <td>
                        {% if row['BillDate'] %}
                            {{ row['BillDate'].strftime('%d/%b/%Y')|upper }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>{{ row['PatientName'] }}</td>
                    <td>
                        <a href="/billdetails?bill_no={{ row['BillNo'] }}&bill_date={{ row['BillDate'].strftime('%Y-%m-%d') if row['BillDate'] else '' }}" target="_blank" class="neat-btn neat-btn-view">
                            <i class="fa-solid fa-eye"></i> View Details
                        </a>
                    </td>
                {% elif view_type == 'purchase' %}
                    <td>{{ row['InvoiceNo'] }}</td>
                    <td>
                        {% if row['InvoiceDateTime'] %}
                            {{ row['InvoiceDateTime'].strftime('%d/%b/%Y')|upper }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>{{ row['SupplierName'] }}</td>
                    <td>
                        <a href="/purchasedetails?invoice_no={{ row['InvoiceNo'] }}&invoice_date={{ row['InvoiceDateTime'].strftime('%Y-%m-%d') if row['InvoiceDateTime'] else '' }}" target="_blank" class="neat-btn neat-btn-view" style="background: #ffb347;">
                            <i class="fa-solid fa-eye"></i> View Details
                        </a>
                    </td>
                {% elif view_type == 'salesreturn' %}
                    <td>{{ row['ReturnBillNo'] }}</td>
                    <td>
                        {% if row['ReturnDate'] %}
                            {{ row['ReturnDate'].strftime('%d/%b/%Y')|upper }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>{{ row['PatientName'] }}</td>
                    <td>
                        <a href="/salesreturnview?return_bill_no={{ row['ReturnBillNo'] }}&return_date={{ row['ReturnDate'].strftime('%Y-%m-%d') if row['ReturnDate'] else '' }}" target="_blank" class="neat-btn neat-btn-view" style="background: #ffc371; color: #333;">
                            <i class="fa-solid fa-eye"></i> View Details
                        </a>
                    </td>
                {% elif view_type == 'cashless' %}
                    <td>{{ row['BillNo'] }}</td>
                    <td>
                        {% if row['BillDate'] %}
                            {{ row['BillDate'].strftime('%d/%b/%Y')|upper }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>{{ row['PatientName'] }}</td>
                    <td>
                        <a href="/billdetails?bill_no={{ row['BillNo'] }}&bill_date={{ row['BillDate'].strftime('%Y-%m-%d') if row['BillDate'] else '' }}" target="_blank" class="neat-btn neat-btn-view">
                            <i class="fa-solid fa-eye"></i> View Details
                        </a>
                    </td>
                {% else %}
                    {% for cell in row.values() %}
                        <td>{{ cell }}</td>
                    {% endfor %}
                {% endif %}
            </tr>
        {% endfor %}
    </tbody>
</table>
{% endmacro %}
